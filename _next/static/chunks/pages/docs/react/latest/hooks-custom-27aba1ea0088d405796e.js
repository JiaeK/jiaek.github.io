(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1084],{17375:function(n,e,t){"use strict";function a(n,e){if(null==n)return{};var t,a,r=function(n,e){if(null==n)return{};var t,a,r={},i=Object.keys(n);for(a=0;a<i.length;a++)t=i[a],e.indexOf(t)>=0||(r[t]=n[t]);return r}(n,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);for(a=0;a<i.length;a++)t=i[a],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(n,t)&&(r[t]=n[t])}return r}t.d(e,{Z:function(){return a}})},36684:function(n,e,t){"use strict";t.r(e),t.d(e,{default:function(){return p}});var a=t(17375),r=t(96156),i=(t(67294),t(3905));function s(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(n);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),t.push.apply(t,a)}return t}function o(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?s(Object(t),!0).forEach((function(e){(0,r.Z)(n,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))}))}return n}var l=function(n){return function(e){return console.warn("Component "+n+" was not imported, exported, or provided by MDXProvider as global scope"),(0,i.kt)("div",o({},e))}},u=l("Intro"),d=l("CodeTab"),c={};function p(n){var e=n.components,t=(0,a.Z)(n,["components"]);return(0,i.kt)("wrapper",o(o(o({},c),t),{},{components:e,mdxType:"MDXLayout"}),(0,i.kt)("h1",o({},{id:"\u6784\u5efa\u81ea\u5b9a\u4e49-hooks"}),"\u6784\u5efa\u81ea\u5b9a\u4e49 Hooks"),(0,i.kt)(u,{mdxType:"Intro"},(0,i.kt)("p",null,"React \u81ea\u5e26\u4e86\u4e00\u4e9b\u57fa\u7840\u7684 hooks\uff0c\u4f8b\u5982 ",(0,i.kt)("inlineCode",{parentName:"p"},"React.useState")," \u6216 ",(0,i.kt)("inlineCode",{parentName:"p"},"React.useEffect"),"\u3002\u672c\u7ae0\u4e2d\u4f60\u5c06\u5b66\u4e60\u5982\u4f55\u9488\u5bf9\u4f60\u7684 React \u7528\u4f8b\u6784\u5efa\u9ad8\u9636 hooks\u3002")),(0,i.kt)("h2",o({},{id:"\u4e3a\u4ec0\u4e48\u81ea\u5b9a\u4e49-hooks\uff1f"}),"\u4e3a\u4ec0\u4e48\u81ea\u5b9a\u4e49 Hooks\uff1f"),(0,i.kt)("p",null,"\u81ea\u5b9a\u4e49 hooks \u53ef\u4ee5\u8ba9\u4f60\u5c06\u73b0\u6709\u7ec4\u4ef6\u7684\u903b\u8f91\u63d0\u53d6\u5230\u53ef\u590d\u7528\u7684\uff0c\u72ec\u7acb\u7684\u51fd\u6570\u4e2d\u3002"),(0,i.kt)("p",null,"\u6211\u4eec\u56de\u987e\u4e00\u4e0b\u4e4b\u524d\u7684\u4f8b\u5b50 ",(0,i.kt)("a",o({parentName:"p"},{href:"./hooks-effect"}),"React.useEffect \u7ae0\u8282"),"\uff0c\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\u6211\u4eec\u6784\u5efa\u4e86\u4e00\u4e2a\u804a\u5929\u5e94\u7528\u7684\u7ec4\u4ef6\uff0c\u7528\u4e8e\u5c55\u793a\u6d88\u606f\uff0c\u663e\u793a\u670b\u53cb\u662f\u5426\u5728\u7ebf\u3002"),(0,i.kt)(d,{labels:["ReScript","JS Output"],mdxType:"CodeTab"},(0,i.kt)("pre",null,(0,i.kt)("code",o({parentName:"pre"},{className:"language-res",metastring:"{16-31}","{16-31}":!0}),'// FriendStatus.res\n\nmodule ChatAPI = {\n  // \u51fa\u4e8e\u6f14\u793a\u7684\u76ee\u7684\uff0cChatAPI\u662f\u865a\u6784\u7684\u4e00\u4e2a\u5168\u5c40\u53d8\u91cf\n  type status = { isOnline: bool };\n  @val external subscribeToFriendStatus: (string, status => unit) => unit = "subscribeToFriendStatus";\n  @val external unsubscribeFromFriendStatus: (string, status => unit) => unit = "unsubscribeFromFriendStatus";\n}\n\ntype state = Offline | Loading | Online;\n\n@react.component\nlet make = (~friendId: string) => {\n  let (state, setState) = React.useState(_ => Offline)\n\n  React.useEffect(() => {\n    let handleStatusChange = (status) => {\n      setState(_ => {\n        status.ChatAPI.isOnline ? Online : Offline\n      })\n    }\n\n    ChatAPI.subscribeToFriendStatus(friendId, handleStatusChange);\n    setState(_ => Loading);\n\n    let cleanup = () => {\n      ChatAPI.unsubscribeFromFriendStatus(friendId, handleStatusChange)\n    }\n\n    Some(cleanup)\n  })\n\n  let text = switch(state) {\n    | Offline => friendId ++ " is offline"\n    | Online => friendId ++ " is online"\n    | Loading => "loading..."\n  }\n\n  <div>\n    {React.string(text)}\n  </div>\n}\n\n')),(0,i.kt)("pre",null,(0,i.kt)("code",o({parentName:"pre"},{className:"language-js"}),'function FriendStatus(Props) {\n  var friendId = Props.friendId;\n  var match = React.useState(function () {\n        return /* Offline */0;\n      });\n  var setState = match[1];\n  React.useEffect(function () {\n        var handleStatusChange = function (status) {\n          return Curry._1(setState, (function (param) {\n                        if (status.isOnline) {\n                          return /* Online */2;\n                        } else {\n                          return /* Offline */0;\n                        }\n                      }));\n        };\n        subscribeToFriendStatus(friendId, handleStatusChange);\n        Curry._1(setState, (function (param) {\n                return /* Loading */1;\n              }));\n        return (function (param) {\n                  unsubscribeFromFriendStatus(friendId, handleStatusChange);\n\n                });\n      });\n  var text;\n  switch (match[0]) {\n    case /* Offline */0 :\n        text = friendId + " is offline";\n        break;\n    case /* Loading */1 :\n        text = "loading...";\n        break;\n    case /* Online */2 :\n        text = friendId + " is online";\n        break;\n\n  }\n  return React.createElement("div", undefined, text);\n}\n'))),(0,i.kt)("p",null,"\u73b0\u5728\uff0c\u5047\u8bbe\u6211\u4eec\u7684\u804a\u5929\u5e94\u7528\u6709\u4e2a\u8054\u7cfb\u4eba\u5217\u8868\uff0c\u6211\u4eec\u60f3\u7528\u7eff\u8272\u5c55\u793a\u5728\u7ebf\u7528\u6237\u7684\u540d\u5b57\u3002\u6211\u4eec\u53ef\u4ee5\u590d\u5236\u7c98\u8d34\u4e0a\u9762\u76f8\u4f3c\u7684\u903b\u8f91\u5230 ",(0,i.kt)("inlineCode",{parentName:"p"},"FriendListItem")," \u7ec4\u4ef6\u4e2d\uff0c\u4f46\u8fd9\u5e76\u4e0d\u4ee4\u4eba\u6ee1\u610f\u3002"),(0,i.kt)(d,{labels:["ReScript","JS Output"],mdxType:"CodeTab"},(0,i.kt)("pre",null,(0,i.kt)("code",o({parentName:"pre"},{className:"language-res",metastring:"{15-30}","{15-30}":!0}),'// FriendListItem.res\ntype state = Offline | Loading | Online;\n\n// module ChatAPI = {...}\n\ntype friend = {\n  id: string,\n  name: string\n};\n\n@react.component\nlet make = (~friend: friend) => {\n  let (state, setState) = React.useState(_ => Offline)\n\n  React.useEffect(() => {\n    let handleStatusChange = (status) => {\n      setState(_ => {\n        status.ChatAPI.isOnline ? Online : Offline\n      })\n    }\n\n    ChatAPI.subscribeToFriendStatus(friend.id, handleStatusChange);\n    setState(_ => Loading);\n\n    let cleanup = () => {\n      ChatAPI.unsubscribeFromFriendStatus(friend.id, handleStatusChange)\n    }\n\n    Some(cleanup)\n  })\n\n  let color = switch(state) {\n    | Offline => "red"\n    | Online => "green"\n    | Loading => "grey"\n  }\n\n  <li style={ReactDOMStyle.make(~color,())}>\n      {React.string(friend.name)}\n  </li>\n}\n')),(0,i.kt)("pre",null,(0,i.kt)("code",o({parentName:"pre"},{className:"language-js"}),'function FriendListItem(Props) {\n  var friend = Props.friend;\n  var match = React.useState(function () {\n        return /* Offline */0;\n      });\n  var setState = match[1];\n  React.useEffect(function () {\n        var handleStatusChange = function (status) {\n          return Curry._1(setState, (function (param) {\n                        if (status.isOnline) {\n                          return /* Online */2;\n                        } else {\n                          return /* Offline */0;\n                        }\n                      }));\n        };\n        subscribeToFriendStatus(friend.id, handleStatusChange);\n        Curry._1(setState, (function (param) {\n                return /* Loading */1;\n              }));\n        return (function (param) {\n                  unsubscribeFromFriendStatus(friend.id, handleStatusChange);\n\n                });\n      });\n  var color;\n  switch (match[0]) {\n    case /* Offline */0 :\n        color = "red";\n        break;\n    case /* Loading */1 :\n        color = "grey";\n        break;\n    case /* Online */2 :\n        color = "green";\n        break;\n\n  }\n  return React.createElement("li", {\n              style: {\n                color: color\n              }\n            }, friend.name);\n}\n'))),(0,i.kt)("p",null,"\u76f8\u53cd\uff0c\u6211\u4eec\u66f4\u671f\u671b\u8fd9\u6bb5\u903b\u8f91\u80fd\u5728 ",(0,i.kt)("inlineCode",{parentName:"p"},"FriendStatus")," \u548c ",(0,i.kt)("inlineCode",{parentName:"p"},"FriendListItem")," \u4e2d\u5171\u7528"),(0,i.kt)("p",null,"\u4f20\u7edf\u4e0a\uff0c\u5728 React \u4e2d\u6709\u4e24\u79cd\u6d41\u884c\u7684\u65b9\u6cd5\u6765\u5728\u7ec4\u4ef6\u95f4\u5171\u4eab\u6709\u72b6\u6001\u7684\u903b\u8f91\uff1a",(0,i.kt)("inlineCode",{parentName:"p"},"render props")," \u548c\u9ad8\u9636\u7ec4\u4ef6\u3002\u73b0\u5728\u8ba9\u6211\u4eec\u770b\u770b Hooks \u662f\u5982\u4f55\u89e3\u51b3\u5927\u591a\u6570\u540c\u7c7b\u7684\u95ee\u9898\uff0c\u800c\u4e0d\u9700\u8981\u5728\u7ec4\u4ef6\u6811\u4e2d\u6dfb\u52a0\u66f4\u591a\u7ec4\u4ef6\u7684\u3002"),(0,i.kt)("h2",o({},{id:"\u63d0\u53d6\u81ea\u5b9a\u4e49-hook"}),"\u63d0\u53d6\u81ea\u5b9a\u4e49 Hook"),(0,i.kt)("p",null,"\u6211\u4eec\u9700\u8981\u5728\u51fd\u6570\u4e4b\u95f4\u5171\u4eab\u903b\u8f91\u65f6\uff0c\u901a\u5e38\u4f1a\u5c06\u903b\u8f91\u63d0\u53d6\u5230\u53e6\u4e00\u4e2a\u51fd\u6570\u4e2d\u3002\u7ec4\u4ef6\u548c Hooks \u90fd\u662f\u51fd\u6570\uff0c\u6240\u4ee5\u8fd9\u4e2a\u601d\u8def\u4e5f\u9002\u7528\u3002"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u81ea\u5b9a\u4e49 Hook \u662f\u4ee5 \u201duse\u201d \u4f5c\u4e3a\u524d\u7f00\u7684\u51fd\u6570\uff0c\u540c\u65f6\u4e5f\u53ef\u80fd\u4f1a\u8c03\u7528\u5176\u5b83\u7684 Hooks\u3002"),"\u4e3e\u4f8b\u6765\u8bf4\uff0c\u4e0b\u9762\u7684 ",(0,i.kt)("inlineCode",{parentName:"p"},"useFriendStatus")," \u662f\u6211\u4eec\u7684\u7b2c\u4e00\u4e2a Hook\uff08\u6211\u4eec\u65b0\u521b\u5efa\u4e86 ",(0,i.kt)("inlineCode",{parentName:"p"},"FriendStatusHook.res")," \u6587\u4ef6\uff0c\u7528\u6765\u5c01\u88c5 ",(0,i.kt)("inlineCode",{parentName:"p"},"state")," \u7c7b\u578b\uff09\uff1a"),(0,i.kt)(d,{labels:["ReScript","JS Output"],mdxType:"CodeTab"},(0,i.kt)("pre",null,(0,i.kt)("code",o({parentName:"pre"},{className:"language-res"}),"// FriendStatusHook.res\n\n// module ChatAPI {...}\n\ntype state = Offline | Loading | Online\n\nlet useFriendStatus = (friendId: string): state => {\n  let (state, setState) = React.useState(_ => Offline)\n\n  React.useEffect(() => {\n    let handleStatusChange = status => {\n      setState(_ => {\n        status.ChatAPI.isOnline ? Online : Offline\n      })\n    }\n\n    ChatAPI.subscribeToFriendStatus(friendId, handleStatusChange)\n    setState(_ => Loading)\n\n    let cleanup = () => {\n      ChatAPI.unsubscribeFromFriendStatus(friendId, handleStatusChange)\n    }\n\n    Some(cleanup)\n  })\n\n  state\n}\n")),(0,i.kt)("pre",null,(0,i.kt)("code",o({parentName:"pre"},{className:"language-js"}),"function useFriendStatus(friendId) {\n  var match = React.useState(function () {\n        return /* Offline */0;\n      });\n  var setState = match[1];\n  React.useEffect(function () {\n        var handleStatusChange = function (status) {\n          return Curry._1(setState, (function (param) {\n                        if (status.isOnline) {\n                          return /* Online */2;\n                        } else {\n                          return /* Offline */0;\n                        }\n                      }));\n        };\n        subscribeToFriendStatus(friendId, handleStatusChange);\n        Curry._1(setState, (function (param) {\n                return /* Loading */1;\n              }));\n        return (function (param) {\n                  unsubscribeFromFriendStatus(friendId, handleStatusChange);\n\n                });\n      });\n  return match[0];\n}\n"))),(0,i.kt)("p",null,"\u91cc\u9762\u6ca1\u5565\u65b0\u7684\u5185\u5bb9\uff0c\u903b\u8f91\u90fd\u662f\u4ece\u4e0a\u9762\u7ec4\u4ef6\u4e2d\u590d\u5236\u8fc7\u6765\u7684\u3002\u5c31\u50cf\u5728\u7ec4\u4ef6\u4e2d\u4e00\u6837\uff0c\u786e\u4fdd\u53ea\u5728\u81ea\u5b9a\u4e49 Hook \u7684\u9876\u5c42\u65e0\u6761\u4ef6\u5730\u8c03\u7528\u5176\u4ed6 Hook\u3002"),(0,i.kt)("p",null,"\u4e0e React \u7ec4\u4ef6\u4e0d\u540c\uff0c\u81ea\u5b9a\u4e49 Hook \u4e0d\u9700\u8981\u5177\u6709\u7279\u5b9a\u7b7e\u540d\u3002 \u6211\u4eec\u53ef\u4ee5\u51b3\u5b9a\u5b83\u63a5\u53d7\u4ec0\u4e48\u4f5c\u4e3a\u53c2\u6570\uff0c\u4ee5\u53ca\u5b83\u5e94\u8be5\u8fd4\u56de\u4ec0\u4e48\uff08\u5982\u679c\u6709\u7684\u8bdd\uff09\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u5b83\u5c31\u50cf\u4e00\u4e2a\u666e\u901a\u7684\u51fd\u6570\u3002\u5b83\u7684\u540d\u79f0\u5e94\u8be5\u59cb\u7ec8\u4ee5 use \u5f00\u5934\uff0c\u4ee5\u4fbf\u4f60\u4e00\u773c\u5c31\u53ef\u4ee5\u770b\u51fa\u5b83\u662f Hooks\u3002"),(0,i.kt)("p",null,"\u6211\u4eec\u7684 ",(0,i.kt)("inlineCode",{parentName:"p"},"useFriendStatus")," Hook \u7684\u7528\u9014\u662f\u8ba2\u9605\u670b\u53cb\u7684\u72b6\u6001\u3002\u6240\u4ee5\u5b83\u5c06 ",(0,i.kt)("inlineCode",{parentName:"p"},"friendId")," \u4f5c\u4e3a\u53c2\u6570\uff0c\u5e76\u8fd4\u56de\u5728\u7ebf\u72b6\u6001\uff0c\u5982 ",(0,i.kt)("inlineCode",{parentName:"p"},"Online"),"\u3001",(0,i.kt)("inlineCode",{parentName:"p"},"Offline")," \u6216 ",(0,i.kt)("inlineCode",{parentName:"p"},"Loading"),"\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",o({parentName:"pre"},{className:"language-res"}),"let useFriendStatus = (friendId: string): status {\n  let (state, setState) = React.useState(_ => Offline);\n\n  // ...\n\n  state\n}\n")),(0,i.kt)("p",null,"\u73b0\u5728\u7528\u4e00\u4e0b\u6211\u4eec\u7684\u81ea\u5b9a\u4e49 Hook\u3002"),(0,i.kt)("h2",o({},{id:"\u4f7f\u7528\u81ea\u5b9a\u4e49-hook"}),"\u4f7f\u7528\u81ea\u5b9a\u4e49 Hook"),(0,i.kt)("p",null,"\u6700\u5f00\u59cb\u6211\u4eec\u7684\u65e2\u5b9a\u76ee\u6807\u662f\u79fb\u9664 ",(0,i.kt)("inlineCode",{parentName:"p"},"FriendStatus")," \u548c ",(0,i.kt)("inlineCode",{parentName:"p"},"FriendListItem")," \u7ec4\u4ef6\u7684\u91cd\u590d\u903b\u8f91\u3002\u8fd9\u4e24\u4e2a\u7ec4\u4ef6\u90fd\u9700\u8981\u77e5\u9053\u670b\u53cb\u7684\u5728\u7ebf\u72b6\u6001\u3002"),(0,i.kt)("p",null,"\u73b0\u5728\u6211\u4eec\u5df2\u7ecf\u5c06\u8fd9\u4e2a\u903b\u8f91\u63d0\u53d6\u5230 ",(0,i.kt)("inlineCode",{parentName:"p"},"useFriendStatus")," hook \u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u5b83\uff1a"),(0,i.kt)(d,{labels:["ReScript","JS Output"],mdxType:"CodeTab"},(0,i.kt)("pre",null,(0,i.kt)("code",o({parentName:"pre"},{className:"language-res",metastring:"{6}","{6}":!0}),'// FriendStatus.res\ntype friend = { id: string };\n\n@react.component\nlet make = (~friend: friend) => {\n  let onlineState = FriendStatusHook.useFriendStatus(friend.id);\n\n  let status = switch(onlineState) {\n    | FriendStatusHook.Online => "Online"\n    | Loading => "Loading"\n    | Offline => "Offline"\n  }\n\n  React.string(status);\n}\n')),(0,i.kt)("pre",null,(0,i.kt)("code",o({parentName:"pre"},{className:"language-js"}),'function FriendStatus(Props) {\n  var friend = Props.friend;\n  var onlineState = useFriendStatus(friend.id);\n  var color;\n  switch (onlineState) {\n    case /* Offline */0 :\n        color = "red";\n        break;\n    case /* Loading */1 :\n        color = "grey";\n        break;\n    case /* Online */2 :\n        color = "green";\n        break;\n\n  }\n  return React.createElement("li", {\n              style: {\n                color: color\n              }\n            }, friend.name);\n}\n'))),(0,i.kt)(d,{labels:["ReScript","JS Output"],mdxType:"CodeTab"},(0,i.kt)("pre",null,(0,i.kt)("code",o({parentName:"pre"},{className:"language-res",metastring:"{4}","{4}":!0}),'// FriendListItem.res\n@react.component\nlet make = (~friend: friend) => {\n  let onlineState = FriendStatusHook.useFriendStatus(friend.id);\n\n  let color = switch(onlineState) {\n    | Offline => "red"\n    | Online => "green"\n    | Loading => "grey"\n  }\n\n  <li style={ReactDOMStyle.make(~color,())}>\n      {React.string(friend.name)}\n  </li>\n}\n')),(0,i.kt)("pre",null,(0,i.kt)("code",o({parentName:"pre"},{className:"language-js"}),'function FriendListItem(Props) {\n  var friend = Props.friend;\n  var onlineState = useFriendStatus(friend.id);\n  var color;\n  switch (onlineState) {\n    case /* Offline */0 :\n        color = "red";\n        break;\n    case /* Loading */1 :\n        color = "grey";\n        break;\n    case /* Online */2 :\n        color = "green";\n        break;\n\n  }\n  return React.createElement("li", {\n              style: {\n                color: color\n              }\n            }, friend.name);\n}\n'))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u8fd9\u4e2a\u4ee3\u7801\u548c\u4e4b\u524d\u7684\u4f8b\u5b50\u662f\u7b49\u4ef7\u7684\u5417\uff1f"),"\u662f\u7684\uff0c\u5b83\u4f1a\u4ee5\u76f8\u540c\u7684\u65b9\u5f0f\u5de5\u4f5c\u3002\u5982\u679c\u4f60\u4ed4\u7ec6\u89c2\u5bdf\uff0c\u4f60\u4f1a\u6ce8\u610f\u5230\u6211\u4eec\u6ca1\u6709\u66f4\u6539\u4efb\u4f55\u884c\u4e3a\u3002\u6211\u4eec\u53ea\u662f\u5c06\u4e24\u4e2a\u51fd\u6570\u4e4b\u95f4\u7684\u4e00\u4e9b\u516c\u5171\u4ee3\u7801\u63d0\u53d6\u5230\u4e00\u4e2a\u5355\u72ec\u7684\u51fd\u6570\u4e2d\u3002\u81ea\u5b9a\u4e49 Hooks \u662f\u4e00\u4e2a\u7ea6\u5b9a\uff0c\u81ea\u7136\u9075\u5faa Hooks \u7684\u8bbe\u8ba1\uff0c\u800c\u4e0d\u662f\u4e00\u4e2a React \u7279\u6027\u3002"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u6211\u7684\u81ea\u5b9a\u4e49 Hooks \u5fc5\u987b\u4ee5 \u201cuse\u201d \u5f00\u5934\u5417\uff1f"),"\u8bf7\u8fd9\u6837\u505a\u5427\u3002\u8fd9\u4e2a\u7ea6\u5b9a\u975e\u5e38\u91cd\u8981\u3002\u6ca1\u6709\u5b83\uff0c\u6211\u4eec\u5c31\u65e0\u6cd5\u81ea\u52a8\u68c0\u67e5\u662f\u5426\u8fdd\u53cd Hooks \u89c4\u5219\uff0c\u56e0\u4e3a\u6211\u4eec\u65e0\u6cd5\u5224\u65ad\u67d0\u4e2a\u51fd\u6570\u5185\u90e8\u662f\u5426\u5305\u542b\u5bf9 Hooks \u7684\u8c03\u7528\u3002"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u4f7f\u7528\u76f8\u540c Hook \u7684\u4e24\u4e2a\u7ec4\u4ef6\u5171\u4eab\u72b6\u6001\u5417\uff1f"),"\u4e0d\u3002\u81ea\u5b9a\u4e49Hook\u662f\u4e00\u79cd\u590d\u7528\u72b6\u6001\u903b\u8f91\u7684\u673a\u5236\uff08\u4f8b\u5982\u8bbe\u7f6e\u8ba2\u9605\u5e76\u8bb0\u4f4f\u5f53\u524d\u503c\uff09\uff0c\u4f46\u662f\u6bcf\u6b21\u4f7f\u7528\u81ea\u5b9a\u4e49 Hook \u65f6\uff0c\u5176\u4e2d\u7684\u6240\u6709\u72b6\u6001\u548c\u6548\u679c\u90fd\u662f\u5b8c\u5168\u9694\u79bb\u7684\u3002"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u81ea\u5b9a\u4e49 Hook \u662f\u5982\u4f55\u9694\u79bb\u72b6\u6001\u7684\uff1f"),"\u5bf9 Hook \u7684\u6bcf\u6b21\u8c03\u7528\u90fd\u4f1a\u83b7\u5f97\u9694\u79bb\u7684\u72b6\u6001\u3002\u56e0\u4e3a\u6211\u4eec\u76f4\u63a5\u8c03\u7528 ",(0,i.kt)("inlineCode",{parentName:"p"},"useFriendStatus"),"\uff0c\u4ece React \u7684\u89d2\u5ea6\u6765\u770b\uff0c\u6211\u4eec\u7684\u7ec4\u4ef6\u53ea\u8c03\u7528\u4e86 ",(0,i.kt)("inlineCode",{parentName:"p"},"useState")," \u548c ",(0,i.kt)("inlineCode",{parentName:"p"},"useEffect"),"\u3002\u800c\u4e14\u6b63\u5982\u6211\u4eec\u4e4b\u524d\u6240\u4e86\u89e3\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u4e00\u4e2a\u7ec4\u4ef6\u4e2d\u591a\u6b21\u8c03\u7528 ",(0,i.kt)("inlineCode",{parentName:"p"},"useState")," \u548c ",(0,i.kt)("inlineCode",{parentName:"p"},"useEffect"),"\uff0c\u5b83\u4eec\u5c06\u662f\u5b8c\u5168\u72ec\u7acb\u7684\u3002"),(0,i.kt)("h3",o({},{id:"\u6280\u5de7\uff1a\u5728-hooks-\u4e4b\u95f4\u4f20\u9012\u4fe1\u606f"}),"\u6280\u5de7\uff1a\u5728 Hooks \u4e4b\u95f4\u4f20\u9012\u4fe1\u606f"),(0,i.kt)("p",null,"\u7531\u4e8e Hooks \u662f\u51fd\u6570\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5728\u5b83\u4eec\u95f4\u4f20\u9012\u4fe1\u606f\u3002"),(0,i.kt)("p",null,"\u4e3a\u4e86\u6f14\u793a\u8fd9\u4e00\u70b9\uff0c\u6211\u4eec\u5c06\u4f7f\u7528\u804a\u5929\u793a\u4f8b\u4e2d\u7684\u53e6\u4e00\u4e2a\u7ec4\u4ef6\u3002\u8fd9\u662f\u4e00\u4e2a\u6d88\u606f\u6536\u4ef6\u4eba\u9009\u62e9\u5668\uff0c\u663e\u793a\u5f53\u524d\u9009\u62e9\u7684\u670b\u53cb\u662f\u5426\u5728\u7ebf\uff1a"),(0,i.kt)(d,{labels:["ReScript","JS Output"],mdxType:"CodeTab"},(0,i.kt)("pre",null,(0,i.kt)("code",o({parentName:"pre"},{className:"language-res",metastring:"{11,12,14-18,22}","{11,12,14-18,22}":!0}),'type friend = {id: string, name: string}\n\nlet friendList = [\n  {id: "1", name: "Phoebe"},\n  {id: "2", name: "Rachel"},\n  {id: "3", name: "Ross"},\n]\n\n@react.component\nlet make = () => {\n  let (recipientId, setRecipientId) = React.useState(_ => "1")\n  let recipientOnlineState = FriendStatusHook.useFriendStatus(recipientId)\n\n  let color = switch recipientOnlineState {\n  | FriendStatusHook.Offline => Circle.Red\n  | Online => Green\n  | Loading => Grey\n  }\n\n  let onChange = evt => {\n    let value = ReactEvent.Form.target(evt)["value"]\n    setRecipientId(value)\n  }\n\n  let friends = Belt.Array.map(friendList, friend => {\n    <option key={friend.id} value={friend.id}>\n      {React.string(friend.name)}\n    </option>\n  })\n\n  <>\n    <Circle color />\n    <select value={recipientId} onChange>\n      {React.array(friends)}\n    </select>\n  </>\n}\n')),(0,i.kt)("pre",null,(0,i.kt)("code",o({parentName:"pre"},{className:"language-js"}),'var friendList = [\n  {\n    id: "1",\n    name: "Phoebe"\n  },\n  {\n    id: "2",\n    name: "Rachel"\n  },\n  {\n    id: "3",\n    name: "Ross"\n  }\n];\n\nfunction Playground(Props) {\n  var match = React.useState(function () {\n        return "1";\n      });\n  var setRecipientId = match[1];\n  var recipientId = match[0];\n  var recipientOnlineState = useFriendStatus(recipientId);\n  var color;\n  switch (recipientOnlineState) {\n    case /* Offline */0 :\n        color = /* Red */0;\n        break;\n    case /* Loading */1 :\n        color = /* Grey */2;\n        break;\n    case /* Online */2 :\n        color = /* Green */1;\n        break;\n\n  }\n  var onChange = function (evt) {\n    return Curry._1(setRecipientId, evt.target.value);\n  };\n  var friends = Belt_Array.map(friendList, (function (friend) {\n          return React.createElement("option", {\n                      key: friend.id,\n                      value: friend.id\n                    }, friend.name);\n        }));\n  return React.createElement(React.Fragment, undefined, React.createElement(Playground$Circle, {\n                  color: color\n                }), React.createElement("select", {\n                  value: recipientId,\n                  onChange: onChange\n                }, friends));\n}\n'))),(0,i.kt)("p",null,"\u6211\u4eec\u5c06\u5f53\u524d\u9009\u62e9\u7684\u670b\u53cb ID \u4fdd\u5b58\u5728 ",(0,i.kt)("inlineCode",{parentName:"p"},"recipientId")," \u72b6\u6001\u53d8\u91cf\u4e2d\uff0c\u5982\u679c\u7528\u6237\u5728 ",(0,i.kt)("inlineCode",{parentName:"p"},"<select>")," \u9009\u62e9\u5668\u4e2d\u9009\u62e9\u4e86\u4e0d\u540c\u7684\u670b\u53cb\uff0c\u5219\u66f4\u65b0\u5b83\u3002"),(0,i.kt)("p",null,"\u56e0\u4e3a ",(0,i.kt)("inlineCode",{parentName:"p"},"useState")," Hook \u8c03\u7528\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86 ",(0,i.kt)("inlineCode",{parentName:"p"},"recipientId")," \u72b6\u6001\u53d8\u91cf\u7684\u6700\u65b0\u503c\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u5b83\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u7ed9\u6211\u4eec\u7684\u81ea\u5b9a\u4e49 ",(0,i.kt)("inlineCode",{parentName:"p"},"FriendStatusHook.useFriendStatus")," Hook\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",o({parentName:"pre"},{className:"language-res"}),'let (recipientId, setRecipientId) = React.useState(_ => "1")\nlet recipientOnlineState = FriendStatusHook.useFriendStatus(recipientId)\n')),(0,i.kt)("p",null,"\u8fd9\u6837\u6211\u4eec\u80fd\u77e5\u9053\u5f53\u524d\u9009\u62e9\u7684\u670b\u53cb\u662f\u5426\u5728\u7ebf\u3002\u5982\u679c\u6211\u4eec\u9009\u62e9\u4e0d\u540c\u7684\u670b\u53cb\u5e76\u66f4\u65b0 ",(0,i.kt)("inlineCode",{parentName:"p"},"recipientId")," \u72b6\u6001\u53d8\u91cf\uff0c\u6211\u4eec\u7684 ",(0,i.kt)("inlineCode",{parentName:"p"},"FriendStatus.useFriendStatus")," Hook\u5c06\u53d6\u6d88\u8ba2\u9605\u4e4b\u524d\u9009\u62e9\u7684\u670b\u53cb\uff0c\u5e76\u8ba2\u9605\u65b0\u9009\u62e9\u7684\u670b\u53cb\u7684\u72b6\u6001\u3002"),(0,i.kt)("h2",o({},{id:"\u53d1\u6325\u4f60\u7684\u60f3\u8c61\u529b"}),"\u53d1\u6325\u4f60\u7684\u60f3\u8c61\u529b"),(0,i.kt)("p",null,"\u81ea\u5b9a\u4e49 Hooks \u63d0\u4f9b\u4e86\u5171\u4eab\u903b\u8f91\u7684\u7075\u6d3b\u6027\u3002\u4f60\u53ef\u4ee5\u7f16\u5199\u81ea\u5b9a\u4e49 Hook \u53bb\u8986\u76d6\u5e7f\u6cdb\u7684\u7528\u4f8b\uff0c\u4f8b\u5982\u8868\u5355\u5904\u7406\u3001\u52a8\u753b\u3001\u58f0\u660e\u5f0f\u8ba2\u9605\u3001\u8ba1\u65f6\u5668\uff0c\u4ee5\u53ca\u66f4\u591a\u6211\u4eec\u6ca1\u6709\u8003\u8651\u5230\u7684\u7528\u4f8b\u3002\u66f4\u91cd\u8981\u7684\u662f\uff0c\u4f60\u53ef\u4ee5\u6784\u5efa\u4e0e React \u7684\u5185\u7f6e\u529f\u80fd\u4e00\u6837\u6613\u4e8e\u4f7f\u7528\u7684 Hooks\u3002"),(0,i.kt)("p",null,"\u5c3d\u91cf\u907f\u514d\u8fc7\u65e9\u5730\u6dfb\u52a0\u62bd\u8c61\u3002\u5f53\u6d89\u53ca\u5230\u8db3\u591f\u591a\u7684\u72b6\u6001\u903b\u8f91\u5904\u7406\u65f6\uff0c\u7ec4\u4ef6\u901a\u5e38\u4f1a\u53d8\u5f97\u5f88\u81c3\u80bf\u3002\u8fd9\u5f88\u6b63\u5e38\uff0c\u4e0d\u8981\u89c9\u5f97\u5fc5\u987b\u7acb\u5373\u5c06\u5176\u62c6\u5206\u4e3a Hooks\u3002\u4f46\u6211\u4eec\u4e5f\u9f13\u52b1\u4f60\u53bb\u53d1\u73b0\u81ea\u5b9a\u4e49 Hook \u7684\u5e94\u7528\u573a\u666f\uff0c\u5b83\u53ef\u4ee5\u5c06\u590d\u6742\u903b\u8f91\u9690\u85cf\u5728\u7b80\u5355\u7684\u63a5\u53e3\u540e\u9762\u6216\u5e2e\u52a9\u4f60\u89e3\u8026\u6742\u4e71\u7684\u7ec4\u4ef6\u3002"))}p.isMDXComponent=!0,p.frontmatter={title:"\u6784\u5efa\u81ea\u5b9a\u4e49 Hooks",description:"\u5982\u4f55\u4f7f\u7528ReScript & React\u6784\u5efa\u4f60\u81ea\u5df1\u7684hooks",canonical:"/docs/react/latest/hooks-custom",__ghEditHref:"https://github.com/reason-association/rescript-lang.org/blob/master/pages/docs/react/latest/hooks-custom.mdx"}},64161:function(n,e,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/docs/react/latest/hooks-custom",function(){return t(36684)}])}},function(n){n.O(0,[92888,49774,40179],(function(){return e=64161,n(n.s=e);var e}));var e=n.O();_N_E=e}]);